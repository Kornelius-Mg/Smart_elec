{% include "header.html" %}

{% include "sidebars.html" %}
<!-- Right Sidebar Backdrop -->
<div class="right-sidebar-backdrop"></div>
<!-- /Right Sidebar Backdrop -->

<!-- Main Content -->
<div class="page-wrapper">
	<div class="container-fluid pt-25">
		<!-- Title -->
			<div class="row heading-bg">
				<div class="col-lg-3 col-md-4 col-sm-4 col-xs-12">
				  <h5 class="txt-dark"></h5>
				</div>
				<!-- Breadcrumb -->
				<div class="col-lg-9 col-sm-8 col-md-8 col-xs-12">
				  <ol class="breadcrumb">
					<li><a href={% url "home" %}>Dashboard</a></li>
					<li><a href={% url "transfos" %}>Transformateurs</a></li>
					<li class="active"><span>Details</span></li>
				  </ol>
				</div>
				<!-- /Breadcrumb -->
			</div>
			<!-- /Title -->
		  <!-- Row -->
		  <div class="row">
			<div class="col-lg-4 col-md-4 col-sm-6 col-xs-12">
				<div class="panel panel-default card-view pa-0">
					<div class="panel-wrapper collapse in">
						<div class="panel-body pa-0">
							<div class="sm-data-box">
								<div class="container-fluid">
									<div class="row">
										<div class="col-xs-6 text-center pl-0 pr-0 data-wrap-left">
											<span class="txt-dark block counter"><span class="font-11">{{transfo.designation}}</span></span>
											<span class="weight-500 uppercase-font block font-13">Transformateur</span>
										</div>
										<div class="col-xs-6 text-center  pl-0 pr-0 data-wrap-right">
											<i class="fa fa-cogs data-right-rep-icon txt-light-grey"></i>
										</div>
									</div>	
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
			<div class="col-lg-4 col-md-4 col-sm-6 col-xs-12">
				<div class="panel panel-default card-view pa-0">
					<div class="panel-wrapper collapse in">
						<div class="panel-body pa-0">
							<div class="sm-data-box">
								<div class="container-fluid">
									<a href="{% url 'compteurs-transfo' transfo.id %}" title="Voir les compteurs">
										<div class="row">
											<div class="col-xs-6 text-center pl-0 pr-0 data-wrap-left">
												<span class="txt-dark block counter"><span class="counter-anim">{{nb_compteurs}}</span></span>
												<span class="weight-500 uppercase-font block font-13">Compteurs</span>
											</div>
											<div class="col-xs-6 text-center  pl-0 pr-0 data-wrap-right">
												<i class="fa fa-cog data-right-rep-icon txt-light-grey"></i></a>
											</div>
										</div>
									</a>	
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
			<div class="col-lg-4 col-md-4 col-sm-6 col-xs-12">
				<div class="panel panel-default card-view pa-0">
					<div class="panel-wrapper collapse in">
						<div class="panel-body pa-0">
							<div class="sm-data-box">
								<div class="container-fluid">
									<div class="row">
										<div class="col-xs-6 text-center pl-0 pr-0 data-wrap-left">
											<span class="txt-dark block counter"><span class="counter-anim">{{charge_rate|floatformat:"2"}}</span></span>
											<span class="weight-500 uppercase-font block font-13">Taux de charge</span>
										</div>
										<div class="col-xs-6 text-center  pl-0 pr-0 data-wrap-right">
											<i class="fa fa-percent data-right-rep-icon txt-light-grey"></i>
										</div>
									</div>	
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
			<div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
				<div class="panel panel-default card-view pa-0">
					<div class="panel-wrapper collapse in">
						<div class="panel-body pa-0">
							<div class="sm-data-box">
								<div class="container-fluid">
									<div class="row">
										<div class="col-xs-3 text-center pl-0 pr-0 data-wrap-left">
											<span class="txt-dark block counter"><span>PHASES</span></span>
											<span class="weight-500 uppercase-font block font-13">Alimentation</span>
										</div>
										<div class="col-xs-3 text-center  pl-0 pr-0 data-wrap-right">
											<span class="txt-dark block">Phase 1</span><input type="checkbox" id="morris_switch1" class="js-switch" data-color="#2ecd99" data-secondary-color="#dedede" data-size="small"/><br/>
										</div>
										<div class="col-xs-3 text-center  pl-0 pr-0 data-wrap-right">
											<span class="txt-dark block">Phase 2</span><input type="checkbox" id="morris_switch2" class="js-switch" data-color="#2ecd99" data-secondary-color="#dedede" data-size="small"/><br/>
										</div>
										<div class="col-xs-3 text-center  pl-0 pr-0 data-wrap-right">
											<span class="txt-dark block">Phase 3</span><input type="checkbox" id="morris_switch3" class="js-switch" data-color="#2ecd99" data-secondary-color="#dedede" data-size="small"/><br/>
										</div>
									</div>	
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
		<!-- /Row -->
			<div class="row">
				<div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
					<div class="panel panel-default card-view">
						<div class="panel-heading">
							<div class="pull-left">
								<h6 class="panel-title txt-dark">Statistiques instantannées</h6>
							</div>
							<div class="pull-right">
								<span class="no-margin-switcher">
									<i class="icon-power mr-10"></i>
									<input type="checkbox" checked=true id="transfo_switch" class="js-switch" data-color="#2ecd99" data-secondary-color="#dedede" data-size="small"/><br/>	
									<label for="transfo_switch" class="label text-danger"><span class="text-uppercase" id="power_state"></span></label>
								</span>
							</div>
						<div class="clearfix"></div>
					</div>
					<div class="panel-wrapper collapse in">
						<ul class="flex-stat mb-10 ml-15">
							<li class="text-left auto-width mr-60">
								<span class="block">P. Active max (KVA)</span>
								<span class="block txt-success weight-500 font-18"><span class="counter-anim">{{ transfo.p_max }}</span></span>
							</li>
							<li class="text-left auto-width mr-60">
								<span class="block">P. active consommée (KVA)</span>
								<span class="block txt-dark weight-500 font-18"><span class="counter-anim success" id="ptotal">{{ transfo.p_total }}</span></span>
							</li>
							<li class="text-left auto-width mr-60">
								<span class="block">P. réactive max (KVAR)</span>
								<span class="block txt-success weight-500 font-18"><span class="counter-anim">{{ transfo.q_max }}</span></span>
							</li>
							<li class="text-left auto-width mr-60">
								<span class="block">P. réactive consommée (KVAR)</span>
								<span class="block txt-dark weight-500 font-18"><span class="counter-anim" id="qtotal">{{ transfo.q_total }}</span></span>
							</li>

						</ul>
						<div id="area_chart" class="morris-chart" style="height:295px;"></div>
					</div>
				</div>
			
				<div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
					<div class="panel panel-default card-view panel-refresh">
						<div class="refresh-container">
							<div class="la-anim-1"></div>
						</div>
						<div class="panel-heading">
							<div class="pull-left">
								<h6 class="panel-title txt-dark">Details instantanés</h6>
							</div>
							<div class="pull-right">
								<a href="#" class="pull-left inline-block refresh mr-15">
									<i class="zmdi zmdi-replay"></i>
								</a>
								<a href="#" class="pull-left inline-block full-screen mr-15">
									<i class="zmdi zmdi-fullscreen"></i>
								</a>
								<div class="pull-left inline-block dropdown">
									<a class="dropdown-toggle" data-toggle="dropdown" href="#" aria-expanded="false" role="button"><i class="zmdi zmdi-more-vert"></i></a>
									<ul class="dropdown-menu bullet dropdown-menu-right"  role="menu">
										<li role="presentation"><a href="javascript:void(0)" role="menuitem"><i class="icon wb-reply" aria-hidden="true"></i>Edit</a></li>
										<li role="presentation"><a href="javascript:void(0)" role="menuitem"><i class="icon wb-share" aria-hidden="true"></i>Delete</a></li>
										<li role="presentation"><a href="javascript:void(0)" role="menuitem"><i class="icon wb-trash" aria-hidden="true"></i>New</a></li>
									</ul>
								</div>
							</div>
							<div class="clearfix"></div>
						</div>
						<div class="panel-wrapper collapse in">
							<div class="panel-body row pa-0">
								<div class="table-wrap">
									<div class="">
										<table id="myTable1" class="table table-hover display  pb-30">
											<thead>
												<tr>
													<th rowspan="2">Instant</th>
													<th colspan="3">Courants</th>
													<th colspan="3">Tensions</th>
													<th colspan="4">Puissances actives</th>
													<th colspan="4">Puissances reactives</th>
												</tr>
												<tr>
													<th>Phase-1</th>
													<th>Phase-2</th>
													<th>Phase-3</th>
													<th>Phase-1</th>
													<th>Phase-2</th>
													<th>Phase-3</th>
													<th>Phase-1</th>
													<th>Phase-2</th>
													<th>Phase-3</th>
													<th>Totale</th>
													<th>Phase-1</th>
													<th>Phase-2</th>
													<th>Phase-3</th>
													<th>Totale</th>
												</tr>
											</thead>
											<tfoot>
												<tr>
													<th>Instant</th>
													<th>Phase 1</th>
													<th>Phase 2</th>
													<th>Phase 3</th>
													<th>Phase 1</th>
													<th>Phase 2</th>
													<th>Phase 3</th>
													<th>Phase 1</th>
													<th>Phase 2</th>
													<th>Phase 3</th>
													<th>Totale</th>
													<th>Phase 1</th>
													<th>Phase 2</th>
													<th>Phase 3</th>
													<th>Totale</th>
												</tr>
											</tfoot>
											<tbody id="tbody">
												{% for detail in details %}
												  <tr>
													  <td>{{detail.instant|timesince}}</td>
													  <td>{{detail.i_phase1}}</td>
													  <td>{{detail.i_phase2}}</td>
													  <td>{{detail.i_phase3}}</td>
													  <td>{{detail.u_phase1}}</td>
													  <td>{{detail.u_phase2}}</td>
													  <td>{{detail.u_phase3}}</td>
													  <td>{{detail.p_phase1}}</td>
													  <td>{{detail.p_phase2}}</td>
													  <td>{{detail.p_phase3}}</td>
													  <td>{{detail.p_total}}</td>
													  <td>{{detail.q_phase1}}</td>
													  <td>{{detail.q_phase2}}</td>
													  <td>{{detail.q_phase3}}</td>
													  <td>{{detail.q_total}}</td>
												  </tr>
												{% endfor %}
											</tbody>
										</table>
									</div>
								</div>	
							</div>	
						</div>
					</div>
				</div>
			</div>
            <!-- Row -->
        </div>	
         <!-- Row -->
    </div>
    </div>
{% load static %}


<!-- Footer -->
<footer class="footer container-fluid pl-30 pr-30">
    <div class="row">
        <div class="col-sm-12">
            <p>2020&copy;By Kornelius-Mg</p>
        </div>
    </div>
</footer>
<!-- /Footer -->

</div>
<!-- /Main Content -->

</div>
<!-- /#wrapper -->

<!-- JavaScript -->
<!-- jQuery -->
<script src={% static "vendors/bower_components/jquery/dist/jquery.min.js" %}></script>

<!-- Bootstrap Core JavaScript -->
<script src={% static "vendors/bower_components/bootstrap/dist/js/bootstrap.min.js" %}></script>

<!-- Vector Maps JavaScript -->
<script src={% static "vendors/vectormap/jquery-jvectormap-2.0.2.min.js" %}></script>
<script src={% static "vendors/vectormap/jquery-jvectormap-world-mill-en.js" %}></script>
<script src={% static "dist/js/vectormap-data.js" %}></script>

<!-- Data table JavaScript -->
<script src={% static "vendors/bower_components/datatables/media/js/jquery.dataTables.min.js" %}></script>
<script src={% static "vendors/bower_components/datatables.net-buttons/js/dataTables.buttons.min.js" %}></script>
<script src={% static "vendors/bower_components/datatables.net-responsive/js/dataTables.responsive.min.js" %}></script>
<script src={% static "dist/js/responsive-datatable-data.js" %}></script>

<!-- Flot Charts JavaScript -->
<script src={% static "vendors/bower_components/Flot/excanvas.min.js" %}></script>
<script src={% static "vendors/bower_components/Flot/jquery.flot.js" %}></script>
<script src={% static "vendors/bower_components/Flot/jquery.flot.pie.js" %}></script>
<script src={% static "vendors/bower_components/Flot/jquery.flot.resize.js" %} ></script>
<script src={% static "vendors/bower_components/Flot/jquery.flot.time.js" %}></script>
<script src={% static "vendors/bower_components/Flot/jquery.flot.stack.js" %}></script>
<script src={% static "vendors/bower_components/Flot/jquery.flot.crosshair.js" %}></script>
<script src={% static "vendors/bower_components/flot.tooltip/js/jquery.flot.tooltip.min.js" %}></script>
<script src={% static "dist/js/flot-data.js" %}></script>

<!-- Slimscroll JavaScript -->
<script src={% static "dist/js/jquery.slimscroll.js" %}></script>

<!-- simpleWeather JavaScript -->
<script src={% static "vendors/bower_components/moment/min/moment.min.js" %}></script>
<script src={% static "vendors/bower_components/simpleWeather/jquery.simpleWeather.min.js" %}></script>
<script src={% static "dist/js/simpleweather-data.js" %}></script>

<!-- Progressbar Animation JavaScript -->
<script src={% static "vendors/bower_components/waypoints/lib/jquery.waypoints.min.js" %}></script>
<script src={% static "vendors/bower_components/jquery.counterup/jquery.counterup.min.js" %}></script>

<!-- Fancy Dropdown JS -->
<script src={% static "dist/js/dropdown-bootstrap-extended.js" %}></script>

<!-- Sparkline JavaScript -->
<script src={% static "vendors/jquery.sparkline/dist/jquery.sparkline.min.js" %}></script>
<script src={% static "vendors/bower_components/jquery.easy-pie-chart/dist/jquery.easypiechart.min.js" %}></script>
<script src={% static "dist/js/skills-counter-data.js" %}></script>

<!-- Owl JavaScript -->
<script src={% static "vendors/bower_components/owl.carousel/dist/owl.carousel.min.js" %}></script>

<!-- ChartJS JavaScript -->
<script src={% static "vendors/chart.js/Chart.min.js" %}></script>

<!-- Chartist JavaScript -->
<script src={% static "vendors/bower_components/chartist/dist/chartist.min.js" %}></script>

<!-- Morris Charts JavaScript -->
<script src={% static "vendors/bower_components/raphael/raphael.min.js" %}></script>
<script src={% static "vendors/bower_components/morris.js/morris.min.js" %}></script>
<script src={% static "vendors/bower_components/jquery-toast-plugin/dist/jquery.toast.min.js" %}></script>

<!-- Counter Animation JavaScript -->
<script src={% static "vendors/bower_components/waypoints/lib/jquery.waypoints.min.js" %}></script>
<script src={% static "vendors/bower_components/jquery.counterup/jquery.counterup.min.js" %}></script>

<!-- Switchery JavaScript -->
<script src={% static "vendors/bower_components/switchery/dist/switchery.min.js" %}></script>

<!-- Bootstrap Select JavaScript -->
<script src={% static "vendors/bower_components/bootstrap-select/dist/js/bootstrap-select.min.js" %}></script>

<!-- Piety JavaScript -->
<script src={% static "vendors/bower_components/peity/jquery.peity.min.js" %}></script>
<script src={% static "dist/js/peity-data.js" %}></script>

<!-- JSgrid table JavaScript -->
<script src={% static "dist/js/db.js" %}></script>
<script src={% static "vendors/bower_components/jsgrid/dist/jsgrid.min.js" %}></script>
<script src={% static "dist/js/jsgrid-data.js" %}></script>

<!-- Calender JavaScripts -->
<script src={% static "vendors/bower_components/moment/min/moment.min.js" %}></script>
<script src={% static "vendors/jquery-ui.min.js" %}></script>
<script src={% static "vendors/bower_components/fullcalendar/dist/fullcalendar.min.js" %}></script>
<script src={% static "dist/js/fullcalendar-data.js" %}></script>

<!-- Progressbar Animation JavaScript -->
<script src={% static "vendors/bower_components/waypoints/lib/jquery.waypoints.min.js" %}></script>	

<!-- Sweet-Alert  -->
<script src={% static "vendors/bower_components/sweetalert/dist/sweetalert.min.js" %}></script>
<script src={% static "dist/js/sweetalert-data.js" %}></script>

<!-- Moment JavaScript -->
<script type="text/javascript" src={% static "vendors/bower_components/moment/min/moment-with-locales.min.js" %}></script>
		
<!-- Bootstrap Colorpicker JavaScript -->
<script src={% static "vendors/bower_components/mjolnic-bootstrap-colorpicker/dist/js/bootstrap-colorpicker.min.js" %}></script>

<!-- Gallery JavaScript -->
<script src={% static "dist/js/isotope.js" %}></script>
<script src={% static "dist/js/lightgallery-all.js" %}></script>
<script src={% static "dist/js/froogaloop2.min.js" %}></script>
<script src={% static "dist/js/gallery-data.js" %}></script>

<!-- twitter JavaScript -->
<script src={% static "dist/js/twitterFetcher.js" %}></script>

<!-- Spectragram JavaScript -->
<script src={% static "dist/js/spectragram.min.js" %}></script>

<!-- Select2 JavaScript -->
<script src={% static "vendors/bower_components/select2/dist/js/select2.full.min.js" %}></script>
		
<!-- Bootstrap Select JavaScript -->
<script src={% static "vendors/bower_components/bootstrap-select/dist/js/bootstrap-select.min.js" %}></script>

<!-- Bootstrap Tagsinput JavaScript -->
<script src={% static "vendors/bower_components/bootstrap-tagsinput/dist/bootstrap-tagsinput.min.js" %}></script>

<!-- Bootstrap Touchspin JavaScript -->
<script src={% static "vendors/bower_components/bootstrap-touchspin/dist/jquery.bootstrap-touchspin.min.js" }></script>

<!-- Multiselect JavaScript -->
<script src={% static "vendors/bower_components/multiselect/js/jquery.multi-select.js" %}></script>

 
<!-- Bootstrap Switch JavaScript -->
<script src={% static "vendors/bower_components/bootstrap-switch/dist/js/bootstrap-switch.min.js" %}></script>

<!-- Bootstrap Datetimepicker JavaScript -->
<script type="text/javascript" src={% static "vendors/bower_components/eonasdan-bootstrap-datetimepicker/build/js/bootstrap-datetimepicker.min.js" %}></script>

<!-- Starrr JavaScript -->
<script src={% static "dist/js/starrr.js" %}></script>

<!-- Init JavaScript -->
<script src={% static "dist/js/init.js" %}></script>

<script>
    var p_max = 0;
    var q_max = 0;
    var btnSwitch = $("#transfo_switch");
    function getCookie(name) {
        var cookieValue = null;
        if (document.cookie && document.cookie != '') {
             cookies = document.cookie.split(';');
            for (var i = 0; i < cookies.length; i++) {
                var cookie = jQuery.trim(cookies[i]);
                // Does this cookie string begin with the name we want?
                if (cookie.substring(0, name.length + 1) == (name + '=')) {
                    cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
                    break;
                }
            }
        }
        return cookieValue;
    }

    function formatDate(date){
        var d = new Date(date);
        var chaine = d.getHours() + ":" + d.getMinutes()+ ":" + d.getSeconds()
        return chaine;
    }

    function afficherDatasDetails(data){
        var datas = JSON.parse(data);
        var corpsTableau = document.getElementById("tbody");
        var tableau = document.getElementById("tab");
        tableau.removeChild(corpsTableau);
        corpsTableau = document.createElement("tbody");
        corpsTableau.id = "tbody";
        tableau.appendChild(corpsTableau);
        for(var i=0;i < datas.length; i++) {
            var element = datas[i];
            var ligne = document.createElement("tr");
            var colonneInstant = document.createElement("td");
            colonneInstant.appendChild(document.createTextNode(formatDate(element["fields"]["instant"])));
            ligne.appendChild(colonneInstant);
            var colonneIPhase1 = document.createElement("td");
            colonneIPhase1.appendChild(document.createTextNode(element["fields"]["i_phase1"]));
            ligne.appendChild(colonneIPhase1);
            var colonneIPhase2 = document.createElement("td");
            colonneIPhase2.appendChild(document.createTextNode(element["fields"]["i_phase2"]));
            ligne.appendChild(colonneIPhase2);
            var colonneIPhase3 = document.createElement("td");
            colonneIPhase3.appendChild(document.createTextNode(element["fields"]["i_phase3"]));
            ligne.appendChild(colonneIPhase3);
            var colonneUPhase1 = document.createElement("td");
            colonneUPhase1.appendChild(document.createTextNode(element["fields"]["u_phase1"]));
            ligne.appendChild(colonneUPhase1);
            var colonneUPhase2 = document.createElement("td");
            colonneUPhase2.appendChild(document.createTextNode(element["fields"]["u_phase2"]));
            ligne.appendChild(colonneUPhase2);
            var colonneUPhase3 = document.createElement("td");
            colonneUPhase3.appendChild(document.createTextNode(element["fields"]["u_phase3"]));
            ligne.appendChild(colonneUPhase3);
            var colonnePPhase1 = document.createElement("td");
            colonnePPhase1.appendChild(document.createTextNode(element["fields"]["p_phase1"]));
            ligne.appendChild(colonnePPhase1);
            var colonnePPhase2 = document.createElement("td");
            colonnePPhase2.appendChild(document.createTextNode(element["fields"]["p_phase2"]));
            ligne.appendChild(colonnePPhase2);
            var colonnePPhase3 = document.createElement("td");
            colonnePPhase3.appendChild(document.createTextNode(element["fields"]["p_phase3"]));
            ligne.appendChild(colonnePPhase3);
            var colonnePTotal = document.createElement("td");
            var p_total = element["fields"]["p_total"];
            colonnePTotal.appendChild(document.createTextNode(p_total));
            ligne.appendChild(colonnePTotal);
            var colonneQPhase1 = document.createElement("td");
            colonneQPhase1.appendChild(document.createTextNode(element["fields"]["q_phase1"]));
            ligne.appendChild(colonneQPhase1);
            var colonneQPhase2 = document.createElement("td");
            colonneQPhase2.appendChild(document.createTextNode(element["fields"]["q_phase2"]));
            ligne.appendChild(colonneQPhase2);
            var colonneQPhase3 = document.createElement("td");
            colonneQPhase3.appendChild(document.createTextNode(element["fields"]["q_phase3"]));
            ligne.appendChild(colonneQPhase3);
            var colonneQTotal = document.createElement("td");
            var q_total = element["fields"]["q_total"];
            colonneQTotal.appendChild(document.createTextNode(q_total));
            ligne.appendChild(colonneQTotal);
            if((p_total < p_max)) {
                ligne.setAttribute("class", "success");
            }
            else if((p_total == p_max)) {
                ligne.setAttribute("class", "warning");
            }
            else if((p_total > p_max)) {
                ligne.setAttribute("class", "danger");
            }
            corpsTableau.appendChild(ligne);
            //console.log("Nouvelle colonne");
        };
    }

    function indicatePowerStateOn() {
        btnSwitch.attr('checked', 'checked');
        $("#power_state").text("Allumé");
        $("#power_state").removeClass("text-danger").addClass("text-success");
    }

    function indicatePowerStateOff() {
        btnSwitch.attr('checked', false);
        $("#power_state").text("Eteint");
        $("#power_state").removeClass("text-success").addClass("text-danger");
    }


    var afficherTransfo = (data) => {
        var datas = JSON.parse(data);
        for(let i=0; i<datas.length; i++)
        {
            let element = datas[i];
            $("#ptotal").text(element["fields"]["p_total"]);
            $("#qtotal").text(element["fields"]["q_total"]) ;
            let state = element['fields']['global_state'];
            if(state == "ON") {
                indicatePowerStateOn();
            } else {
                indicatePowerStateOff();
            }
            p_max = element['fields']['p_max'];
            p_max = element['fields']['q_max'];
        }
    }

    $.ajaxSetup(
            {'X-CSRFToken': getCookie("csrftoken"), 'Content-type': 'json/application'}
    );

    var startEngin = () => {
        console.log("ALlumage d'un transfo");
        $.ajax({
            url: '{% url "start-transfo" object.id %}',
            method: "GET",
            success: (datas) => {
                btnSwitch.attr("checked", true);
            },
            error: (error) => {
                console.warn("L'allumage du tranfo n'a pas reussi");
            }
            
        });
    }

    var stopEngin = () => {
        console.log("Extinction d'un transfo");
        $.ajax({
            url: '{% url "stop-transfo" object.id %}',
            method: 'GET',
            success: (datas) => {
                btnSwitch.attr("checked", false);
            },
            error: (error) => {
                console.warn("L'extinction du transfo a echoué");
            }
        });
    }

    var setPowerState = () => {
        if(btnSwitch.is(":checked")) {
            indicatePowerStateOn();
        }
        else{
            indicatePowerStateOff();
        }
    }

    $(document).ready(() => {
        console.log("Chargement de la page");
        setInterval(
            () => {
                $.get(
                    '{% url "transfo-infos" object.id %}',
                    (datas) => {
                        afficherTransfo(datas);
                    }
                )
                $.get(
                    '{% url "transfo" object.id %}',
                    (datas) => {
                        afficherDatasDetails(datas);
                    },
                )
            }, 3000
        );
        setPowerState();
        $("#link-transfos").addClass("active");
    });
</script>

<script src={% static "dist/js/dashboard-data.js" %}></script>

</body>

</html>
